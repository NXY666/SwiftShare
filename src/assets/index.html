<!DOCTYPE html>
<html lang="zh-Hans">
<head>
	<title>快传</title>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=0.8, user-scalable=no">
	<meta name="description" content="快传，传递文本、传输文件、持久共享及在线播放。支持多线程上传、边传边下等特色功能。">
	<meta name="keywords" content="快传, 传输, 简洁, 快捷, 文本, 文件, 媒体, 提取, 下载, 播放">
	<script src="https://fastly.jsdelivr.net/npm/qrcode-generator@1.4.4"></script>
	<script>
		const base = window.location.pathname.replace(/\/$/, '');

		function completeUrl(url) {
			return new URL(base + url.replace(/^([^/])/, "/$1"), location).href;
		}

		function completeWsUrl(url) {
			return completeUrl(url).replace(/^http/, 'ws');
		}

		// base不在根目录上
		if (base) {
			const observer = new MutationObserver(mutationsList => {
				for (let mutation of mutationsList) {
					if (mutation.type === 'childList') {
						mutation.addedNodes.forEach(node => {
							switch (node.tagName) {
								case 'SCRIPT': {
									if (node.src) {
										try {
											new URL(node.src);
										} catch {
											node.src = completeUrl(node.src);
										}
									}
									break;
								}
								case 'LINK': {
									if (node.href) {
										try {
											new URL(node.href);
										} catch {
											node.href = completeUrl(node.href);
										}
									}
									break;
								}
							}
						});
					}
				}
			});

			const config = {childList: true, subtree: true};

			observer.observe(document, config);
		}
	</script>
	<script src="./js/page.js"></script>
	<script defer src="./js/dialog.js"></script>
	<script defer src="./js/websocket.js"></script>
	<script defer src="./js/index.js"></script>
	<link rel="stylesheet" href="./css/common.css">
	<link rel="stylesheet" href="./css/index.css">
	<link rel="icon" type="image/x-icon" href="./favicon.ico">
</head>
<body>
	<h1 class="width-full title">
		<svg height="35" id="titleIcon" viewBox="0 0 1024 1024" width="35"
			 xmlns="http://www.w3.org/2000/svg">
			<path d="M853.333333 0a170.666667 170.666667 0 0 1 170.666667 170.666667v682.666666a170.666667 170.666667 0 0 1-170.666667 170.666667H170.666667a170.666667 170.666667 0 0 1-170.666667-170.666667V170.666667a170.666667 170.666667 0 0 1 170.666667-170.666667h682.666666z m-82.346666 255.857778H682.666667v34.986666l-0.199111 3.043556a22.129778 22.129778 0 0 1-19.313778 18.830222l-3.015111 0.199111H363.804444l-3.015111-0.227555a22.385778 22.385778 0 0 1-19.171555-18.887111l-0.199111-2.986667V256.284444H253.44l-3.185778 0.199112a25.799111 25.799111 0 0 0-22.471111 22.101333L227.555556 281.827556v517.518222l0.199111 3.128889c1.422222 11.406222 10.609778 20.736 22.414222 22.186666L253.44 824.888889l520.561778-0.028445c10.126222-0.398222 20.878222-3.925333 22.272-21.902222l0.170666-4.039111V281.400889l-0.113777-2.929778a25.514667 25.514667 0 0 0-22.129778-22.414222l-3.214222-0.199111z m-218.168889 287.971555a19.911111 19.911111 0 0 1 25.173333-1.564444l2.474667 1.991111 69.802666 68.864 2.104889 2.446222a18.915556 18.915556 0 0 1 3.584 11.406222c0 4.152889-1.393778 8.334222-3.754666 11.605334l-1.934223 2.275555-71.566222 70.570667-2.446222 1.905778a20.48 20.48 0 0 1-11.576889 3.726222 19.740444 19.740444 0 0 1-14.506667-6.058667 19.968 19.968 0 0 1-1.251555-25.685333l2.133333-2.474667 36.864-36.380444h-198.826666l-2.730667-0.170667c-9.841778-1.336889-18.318222-9.813333-17.92-19.740444a19.768889 19.768889 0 0 1 16.839111-18.858667l2.929778-0.199111h199.708444l-35.100444-34.645333-1.991111-2.275556a20.252444 20.252444 0 0 1 1.991111-26.737778z m-108.316445-160c8.021333-5.859556 19.911111-5.546667 27.107556 1.934223a19.228444 19.228444 0 0 1 1.592889 24.832l-2.019556 2.446222-35.128889 34.645333h198.4l2.730667 0.199111c9.870222 1.336889 18.318222 9.813333 17.92 19.712-0.398222 9.841778-6.968889 17.550222-16.412444 18.858667l-2.901334 0.199111h-199.281778l34.673778 34.218667 1.991111 2.332444a19.768889 19.768889 0 0 1-0.682666 24.519111 18.773333 18.773333 0 0 1-14.933334 6.940445 19.541333 19.541333 0 0 1-11.576889-3.555556l-2.474666-2.076444-69.347556-68.437334-2.133333-2.446222a19.029333 19.029333 0 0 1 0-22.812444l2.133333-2.446223 68.039111-67.128888 2.275556-1.934223zM637.240889 199.111111h-250.481778a16.981333 16.981333 0 0 0-16.753778 13.368889L369.777778 214.954667v53.589333c0 7.708444 6.314667 14.392889 14.279111 15.644444l2.702222 0.227556h250.481778c8.248889 0 15.416889-6.257778 16.753778-13.767111l0.227555-2.56V215.011556c0-7.708444-6.314667-14.392889-14.279111-15.644445L637.240889 199.111111z"
				  data-spm-anchor-id="a313x.search_index.0.i0.3c033a81mHw9Ww"></path>
		</svg>
		快传
	</h1>

	<page-bar style="margin: 25px auto;">
		<page-item for="text">文本</page-item>
		<page-item for="file">文件</page-item>
		<page-item for="drop">投送</page-item>
	</page-bar>

	<page-content id="text">
		<div class="width-full box">
			<div class="box-inner">
				<h2 class="box-title">上传文本</h2>
				<form id="uploadTextForm">
					<label class="hide" for="uploadTextInput"></label>
					<textarea cols="50" id="uploadTextInput" maxlength="67108864" placeholder="文本"
							  rows="8"></textarea>
					<button id="uploadTextButton">上传</button>
				</form>
			</div>
		</div>
		<div class="width-full box">
			<div class="box-inner">
				<h2 class="box-title">提取文本</h2>
				<form class="input-form" id="extractTextForm">
					<label class="hide" for="extractTextCode"></label>
					<input autocomplete="off" id="extractTextCode" placeholder="提取码" type="text">
					<button>提取</button>
				</form>
				<pre id="extractedText">:)</pre>
				<button id="copyExtractedTextButton">复制</button>
			</div>
		</div>
	</page-content>

	<page-content id="file">
		<div class="width-full box">
			<div class="box-inner">
				<h2 class="box-title">上传文件</h2>
				<form class="input-form" id="uploadFileForm">
					<label class="hide" for="uploadFileInput"></label>
					<input id="uploadFileInput" multiple type="file">
					<button>上传</button>
				</form>
			</div>
		</div>
		<div class="width-full box">
			<div class="box-inner">
				<h2 class="box-title">下载文件</h2>
				<form class="input-form" id="extractFileForm">
					<label class="hide" for="extractFileCode"></label>
					<input autocomplete="off" id="extractFileCode" placeholder="提取码" type="text">
					<button>下载</button>
				</form>
			</div>
		</div>
		<div class="width-full box">
			<div class="box-inner">
				<h2 class="box-title">播放媒体</h2>
				<form class="input-form" id="playFileForm">
					<label class="hide" for="playFileCode"></label>
					<input autocomplete="off" id="playFileCode" placeholder="提取码" type="text">
					<button>播放</button>
				</form>
				<div id="playFileVideoContainer">
					<video controls id="playFileVideo"></video>
				</div>
			</div>
		</div>
	</page-content>

	<page-content id="drop">
		<div class="width-full box">
			<div class="box-inner">
				<h2 class="box-title">发送</h2>
				<form class="input-form" id="dropConnectForm">
					<label class="hide" for="dropConnectCode"></label>
					<input autocomplete="off" id="dropConnectCode" placeholder="连接码" type="text">
					<button>连接</button>
				</form>
				<div id="dropSender">
					<div class="drop-send-box">
						<h3 class="drop-send-box-title">发送文本</h3>
						<form id="dropUploadTextForm">
							<label class="hide" for="dropUploadTextInput"></label>
							<textarea cols="50" id="dropUploadTextInput" maxlength="67108864" placeholder="文本"
									  rows="8"></textarea>
							<button id="dropUploadTextButton">发送</button>
						</form>
					</div>
					<div class="drop-send-box">
						<h3 class="drop-send-box-title">发送文件</h3>
						<form class="input-form" id="dropUploadFileForm">
							<label class="hide" for="dropUploadFileInput"></label>
							<input id="dropUploadFileInput" multiple type="file">
							<button>发送</button>
						</form>
					</div>
				</div>
			</div>
		</div>
		<div class="width-full box">
			<div class="box-inner">
				<h2 class="box-title">接收</h2>
				<button id="dropRecvSwitchButton">启用</button>
				<div id="dropRecvHelper">
					<span id="dropQrCode"></span>
					<div class="drop-recv-method-list">
						<div class="drop-recv-method">
							<b>连接方法１：</b><br>
							扫描左侧二维码快速连接。
						</div>
						<div class="drop-recv-method">
							<b>连接方法２：</b><br>
							凭连接码【<span id="dropCode"></span>】手动连接。
						</div>
					</div>
				</div>
				<div id="dropRecvDataList" class="drop-recv-data-list empty">
					<template id="dropRecvDataTemplate">
						<div class="drop-recv-data">
							<div class="stick"></div>
							<div class="detail">
								<b class="type">类型</b>
								<span class="content">内容</span>
							</div>
							<button class="operate-button">按钮</button>
						</div>
					</template>
				</div>
			</div>
		</div>
	</page-content>

	<a class="water-mark" href="https://github.com/NXY666/SwiftShare">快传 - SwiftShare</a>
</body>
</html>
